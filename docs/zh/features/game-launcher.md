---
headerDepth: 2
category: [功能, 教程]
tag: [帧率解限, 服务器转换, 切换帐号]
tag: [帧率解限, 服务器转换, 切换帐号]
order: 4
comment: false
description: 胡桃工具箱内的游戏启动器相较于官方启动器，不仅允许用户添加自定义的启动参数，还内置了服务器转换和帧率解限等显著提升游戏体验的功能。
---

# 高级启动器

![游戏启动器](https://img.alicdn.com/imgextra/i4/1797064093/O1CN014YLRnj1g6e0zQaBl6_!!1797064093.png_.webp)

- 胡桃工具箱提供的高级启动器功能中通过多样的设置选项来允许用户以自定义设置启动游戏
- 你可以通过点击左侧菜单栏中的“启动游戏”进入高级启动器功能
  - 第一次使用时你将自动跳转到设置页面以设置你的游戏路径
  - 选择游戏路径时，请注意此处选择的**应是游戏本身（`YuanShen.exe`）而非游戏启动器（`launcher.exe`）**
    - 例如（仅作示范，请以实际情况为准）：
      `D:\miHoYo Launcher\games\Genshin Impact Game\YuanShen.exe`
- 在设置完毕启动游戏所需的附加选项后，点击右上角的“启动游戏”按钮即可，附加选项请看本页下方的功能文档

## 切换服务器

::: tip 权限提示
1. 使用该功能时需要以管理员权限启动胡桃
2. 胡桃工具箱会在数据目录下创建一个名为 `ServerCache` 的文件夹并储存转换服务器所需要的文件
  该文件将始终被保留以便您能快速地切换服务器，并将在转服过程中自动检查更新
:::

- 进入“启动游戏”页面
- 在“服务器”项中选择对应的服务器

**目前可选的服务器包括：**

| 选项            | 服务器                                            |
| --------------- | ------------------------------------------------- |
| 官方服 Default  | 中国大陆服务器                                    |
| 官方服 Official | 中国大陆服务器，与上一栏无实质区别                |
| 官方服 NoTapTap | 禁用 TapTap 帐号登录的中国大陆服务器              |
| 渠道服 Default  | 使用 BiliBili 帐号登录的中国大陆服务器            |
| 国际服 Default  | HoYoverse 国际服服务器                            |
| 国际服 Official | HoYoverse 国际服服务器，与上一栏无实质区别        |
| 国际服 Epic     | 使用 Epic 商城支付网关的 HoYoverse 国际服服务器   |
| 国际服 Google   | 使用 Google Pay 支付网关的 HoYoverse 国际服服务器 |

- 点击右上角的“启动游戏”按钮，胡桃会从对应的米哈游官方服务器自动下载并应用相关文件，之后将自动启动游戏
- 在未实际启动游戏前，胡桃不会实际更改本选项的值

## 账号保存

::: tip
本功能所描述的账号，特指当前原神所登录游戏账号的登录状态
:::

|              | 官方服 | 国际服 | 渠道服 |
| ------------ | ------ | ------ | ------ |
| 保存登录状态 | 支持   | 支持   | 支持   |
| 切换账号     | 支持   | 支持   | 不支持 |

1. 进入“启动游戏”功能页面
2. 点击“检测账号”，胡桃工具箱会保存当前原神游戏的登录状态
3. 在弹出的“为账号命名”界面中，输入您要为此账号设置的名称，点击确认
4. 在游戏中，注销当前登录并登录你另一个账号，随后关闭游戏。重复执行上述的第二步和第三步直至你将全部的账号添加进胡桃工具箱中。
5. 此时即可在账号切换功能下方自由选择您要切换的账号
  - 每个已保存的账号均可通过点击直接切换
  - 您可以拖动账户对它们进行排序
  - 在其右侧有三个按钮，分别为：
    - “绑定当前用户角色”，即将您当前选择的米游社登录状态绑定至该账号中，点击该按钮后，对应的 UID 将出现在该账号自定义名称的下方，可帮你分辨账号
    - “重命名”，即修改当前选择账号的自定义名称
    - “删除”，即删除当前选择的账号
6. 不同的服务器将分别保存账号登陆状态
  - 例如国服登陆了账号 A，外服登陆了账号 B；则 A 仅在服务器选项为国服时可见，B 仅在服务器选项为外服时可见

## 使用 米游社 / HoYoLAB 用户登陆

::: warning
使用本选项前，你**必须开启“启动参数”选项**（与其子选项无关）
:::

在启用本选项时，胡桃工具箱将直接使用你已登录的 米游社 / HoYoLAB 账户登陆其绑定的原神账号。

## Windows 平台上的原神 HDR

~~原神目前内置了仅能通过设置注册表键值开启的 HDR 功能，虽然此举可能意味着该功能属于游戏的测试功能，但是你已经能够抢先体验！~~

~~可以在支持 HDR 的显示器上启用 Windows 平台上的原神 HDR 功能以提升视觉体验。在游戏启动器中，你可以启用 Windows HDR 选项，胡桃工具箱会在游戏启动时激活游戏的此内置功能。~~

原神暂时禁用了 HDR 功能，因此该功能暂时无法生效。

## 启动参数

- 在“启动游戏-进程”中，启用“启动参数” 功能，点击展开后你可以设置更多细节：
  - `-window-mode exclusive` 参数
    - **独占全屏**，即选择游戏进程以独占全屏模式运行
      - **该功能与游戏内浏览器功能不兼容，你应仅在能独立描述独占全屏的技术原理和效果的情况下开启本项**
  - `-screen-fullscreen` 参数
    - **全屏**，即选择启动游戏后的游戏界面是否设置为全屏
  - `-popupwindow` 参数
    - **无边框**，即选择启动游戏后的游戏界面是否设置为无边框窗口
  - `-platform_type CLOUD_THIRD_PARTY_MOBILE` 参数
    - **触摸屏模式**，即启用原神内置的触摸屏操作模式（键鼠输入将被忽略）
  - 分辨率
    - 该功能可以快速设置下方的覆盖屏幕宽度和高度选项，有一些常见的预设项可供选择
  - `-screen-width` 参数
    - **宽度**，即选择启动游戏后的游戏界面的宽度，例如 `1920`
  - `-screen-height` 参数
    - **高度**，即选择启动游戏后的游戏界面的高度，例如 `1080`
  - `-monitor` 参数
    - **显示器**，允许多显示器用户选择指定的显示器来运行游戏
      - 如果你无法判断各选项代表的显示器，可以点击 “识别显示器” 来获得提示
        ::: warning
        请注意，修改主显示器可能会导致游戏出现在与编号不对应的显示器上。
        :::

## 资源下载

胡桃工具箱在“启动游戏-资源下载”页签会列出实时的原神国服游戏的安装包和增量包。用户可以点击对应包右侧的超链接按钮以跳转到浏览器并开始下载对应的文件，从而使用自己偏好的下载工具下载游戏。

当用户需要进行游戏版本升级时，可以执行以下步骤：

1. 升级官方启动器
2. 在胡桃工具箱中找到对应版本的增量包及已安装语言的升级包，点击下载
3. 将所有下载的压缩包移动至与游戏程序同级的目录中
4. 启动官方启动器，点击更新按钮。此时官方启动器将跳过下载步骤，直接解压升级包并完成升级

## 注入功能

::: caution
- 请注意：注入功能已明确标注为“**Dangerous Feature**”，即 **危险功能**，选择启用即代表您选择自行承担可能导致的一切风险
- **你需要使用管理员权限启动胡桃，再开启“启动游戏-注入”选项以启用该功能**
:::

### 帧率限制解除

::: caution
- [Unlocker 项目](https://github.com/DGP-Studio/Unlocker)仅作用于 UnityPlayer 本身，即直接作用于 Unity3D 引擎，与游戏本体不发生直接关系，本质上与移动端中“120帧率”等设置无异，但您仍应谨慎使用并自行阅读[用户协议](../statements/tos.md#总则)
:::

- 使用“管理员模式”启动胡桃工具箱
- 在“启动游戏-游戏选项-注入”模块的最下方可见“目标帧率”选项
  - 本选项仅强制指定游戏的最高帧率上限，实际帧数取决于设备性能，请酌情设定
  - 设置远超设备实际性能的过大数值可使游戏崩溃
- 点击右上角的“启动游戏”按钮

会导致**帧率限制解除失败**的因素：

1. 胡桃工具箱没有保持在后台运行
2. 游戏内未关闭**垂直同步**选项
3. 在显卡驱动中存在“最大帧速率”的设置
4. 在显卡驱动软件内存在未关闭的类似于“节能模式”的选项
5. 显卡性能不足
6. 未安装 MSVCRT 库

### 视野调整

开启后将调整相机视野，并调整迷雾可见性等相关设置。具体信息可参照程序提示。

### 队伍配置进度条设置

可配置队伍进度条可见性

## 进程间

> 进程间来源于术语 `Interprocess`，在本段中代表 Snap Hutao 与其它应用的联动功能

### 时长统计

**使用时长统计功能，需要安装并配置 [Starward](https://github.com/Scighost/Starward) 应用程序**

启用该功能后，胡桃将会调用 Starward 通信接口，使其在 Snap Hutao 启动原神游戏后开始时长统计，你将可以在 Starward 客户端中看到你的时长游戏统计

### Better GI

**使用 Better GI 联动功能需要安装并配置 [Better Genshin Impact](https://bgi.huiyadan.com/) 应用程序**，请先启动一次 BGI 程序再使用原神的链式启动功能

启用该功能后，胡桃将会调用 Better Genshin Impact 的通信接口，使其在 Snap Hutao 启动游戏后，启动其基于计算机视觉技术（OCR）的自动化功能。

### Discord Activity

**使用 Discord Activity 联动功能需要安装并配置 [Discord](https://discord.com/) 应用程序**

启用该功能后，胡桃将生成 Discord 资料卡上的游戏状态并实时更新。

## 常见问题

### 如何通过胡桃工具箱快速启动游戏

- 在主程序中正确设置高级启动器功能
- 在胡桃工具箱的主窗口未关闭时，您可以直接点击“主页-启动游戏”以快速启动
- 点击任务栏右下角的胡桃图标（通常会被系统自动收纳），选择启动游戏

  ![quick-start](https://img.alicdn.com/imgextra/i3/1797064093/O1CN01Uu8QzN1g6du6MRp8h_!!1797064093.png_.webp)

### 为什么游戏登录状态会失效，导致切换账号功能无效

- 保存游戏登录状态的要素有两个：网络环境和设备 ID
- 导致该问题的常见原因是：
  - 网络环境频繁变换，如公网 IP 更换
  - 网络设备变换，比如网卡更新、MAC 地址更换
  - 操作失误，导致实际上根本没有保存登录状态（空的登录状态无法避免被胡桃识别）
    - 确认你的账号已登录后，进入游戏
    - 关闭游戏后，确定游戏进程已关闭
    - 再次进行账号检测，来添加登录状态

### 开门时出现错误码 `31-4302`

如在开门时出现错误码 `31-4302` 可通过开启“启动游戏-注入-让我进去”选项以解决此问题

### 转换服务器失败后如何恢复游戏程序

::: info 功能原理说明
胡桃客户端始终只从原神官方服务器下载转换服务器需要的文件，这保证了用户不会下载到被第三方篡改的危险程序。
如果你在转换到某一种目标服务器时频繁因网络问题而转换失败，则意味你的网络到目标的原神官方服务器连接质量差。
你应检查你的互联网连接、联系你的运营商或向专业人士咨询以保证你的正常使用体验。
:::

在转换原神服务器时，如果胡桃客户端意外退出或由于用户侧网络问题会导致转换流程中断并进而导致原神客户端损坏。
此时胡桃工具箱会提示 `游戏路径不正确，前往设置更改游戏路径`，而游戏路径下此时可能没有游戏主程序文件，导致用户无法正确设置。

在这种情况下，用户可以执行下面的步骤**手动将胡桃客户端备份的游戏主程序恢复至原本的游戏目录中**或**直接使用官方启动器修复游戏**。

在开始手动恢复游戏程序之前，你需要知道以下基本知识：

- 关于游戏客户端
  1. 国服原神客户端目录下有名为 `YuanShen.exe` 的游戏主程序和名为 `YuanShen_Data` 的游戏程序目录
  2. 国际服原神客户端目录下有名为 `GenshinImpact.exe` 的游戏主程序和名为 `GenshinImpact_Data` 的游戏程序目录
- 关于胡桃客户端转换服务器功能下的备份步骤
  1. 在转换服务器前，胡桃客户端会备份当前游戏客户端的主程序以及国服 / 国际服客户端专有的一些组件程序，即 `exe` 主程序和 `*_Data` 目录
  2. 备份文件储存于当前 Windows 用户下的文档库中的 `Hutao/ServerCache` 目录下，即 `%userprofile%/Documents/Hutao/ServerCache`

手动恢复游戏主程序步骤（此处以国际服转国服为例）：

1. 进入胡桃用于备份游戏主程序的 `ServerCache` 目录，此时该目录下存放着转换前的游戏程序备份文件，即 `GenshinImpact.exe` 和 `GenshinImpact_Data`
2. 进入游戏主程序目录，此时既没有 `YuanShen.exe` 也没有 `GenshinImpact.exe`，并且有一个国服目录 `YuanShen_Data`
3. 手动将游戏主程序目录下的 `YuanShen_Data` 文件夹更名为 `GenshinImpact_Data`
4. 手动将 `Hutao/ServerCache` 下的 `GenshinImpact.exe` 和 `GenshinImpact_Data` 复制回游戏主程序目录中并覆盖当前已有文件
5. 此时你的游戏客户端应已恢复正常
6. 重新进入胡桃客户端的“启动游戏”界面并启动，“游戏路径不正确”的错误应不再出现，且“服务器”设置一栏为空。此时，你可以选择原本的服务器版本（国际服）并立刻启动游戏，或选择新的服务器目标（国服）并转换客户端版本。

### 如何恢复 `config.ini` 配置文件

在某些特定条件下（如游戏目录权限错误），`config.ini` 文件会在转服后丢失。这会造成无法进入胡桃工具箱高级启动器界面和游戏无法正常启动。

在判断你当前的游戏版本后，你可以在游戏目录 `%your_launcher_folder%/Genshin Impact Game/` 下手动创建并填入对应的配置文件，下面是常见的配置文件内容。

::: info
请自行修改 `game_version` 至当前游戏版本
:::

::: tabs#game_config_samples
@tab 国服 Official

```ini
[General]
channel=1
cps=mihoyo
game_version=4.1.0
sub_channel=1
plugin_7_version=1.0.0
```

@tab 国际服 Official

```ini
[General]
channel=1
cps=mihoyo
game_version=4.1.0
sub_channel=0
plugin_7_version=1.0.0
```
:::
