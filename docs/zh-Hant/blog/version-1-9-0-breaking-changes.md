---
category: [開發日誌]
order: 1
comment: false
description: 本文內容適用於 Snap Hutao **1.4.11~1.8.4 版本**升級至 1.9.0 及更高版本
---

# 1.9.0 版本重大改變詳情

本文內容適用於 Snap Hutao **1.4.11~1.8.4 版本**升級至 1.9.0 及更高版本

## 前言

Snap Hutao 是一個使用 MSIX 格式的 Windows 沙盒應用程式，它帶來了安裝的便利性和 AppX 應用的安全性。對安裝包強制性的程式碼簽章是確保安全性的重要因素之一：在安裝包被竄改時，Windows App Installer 會因為簽章被破壞而彈出錯誤，進而禁止使用者安裝，這在主流行動裝置作業系統中已經被普及。在 Windows 平台下，由於嚴格的身份審查制度，程式碼簽署憑證價格一直保持在很高的價格上。

Snap Hutao 在1.4.11版本前，使用了自簽名憑證的方法。在這種模式下，使用者需要手動安裝 DGP-Studio 的憑證，才能讓作業系統允許 DGP-Studio 憑證簽署的應用程式安裝於電腦上。自1.4.11版本起，Snap Hutao 上架微軟商店，微軟為胡桃的開發者帳號提供了一個GUID `35C8E923-85DF-49A7-9172-B39DC6312C52` 並以此為用戶名為胡桃工具箱提供了免費的簽名。如果您習慣使用 msix 安裝套件更新胡桃工具箱，那麼您應該總是能在發布者一欄中看到這個 GUID。

在 Microsoft Store 發布使得胡桃工具箱的使用者不再需要手動安裝簽名憑證，還為胡桃工具箱安裝包的分發提供了支持，為開發團隊降低了大量的成本。但是，繁瑣冗長的審核流程經常打亂胡桃工具箱的開發計劃，因此開發團隊在過去的半年中一直在尋找解決方案。 SignPath 是一家位於奧地利維也納的提供代碼簽名整合軟體的公司。在2023年12月初，Snap Hutao 的開發團隊成功地獲得了 SignPath 基金會的支持，被允許免費使用其提供的代碼簽名憑證為胡桃工具箱簽名。這大大幫助了 Snap Hutao 計畫：不僅允許胡桃工具箱脫離 Microsoft Store 的束縛，還避免了每年高昂的憑證費用。

**由於遷移至新憑證會帶來包名衝突問題，Snap Hutao 提供以下詳細解釋可協助所有使用者更新至 1.9.0 及未來的版本。**

## 升級至 1.9.0 版本

### 版本發布

Snap Hutao 1.9.0 版本將在2023年聖誕節前的周末發布，我們將透過 GitHub，極狐GitLab，官方網站和社群發布安裝包的下載地址。

> 1.9.0 版本已發布，請在[快速開始](../quick-start.md#全新安裝)頁面取得

### 解除安裝舊版本

由於套件名稱和簽名衝突，直接安裝安裝套件會根據您的系統版本出現問題。

|  系統版本  |                           預計的問題                            |
| :--------: | :-------------------------------------------------------------: |
| Windows 10 |                    無法安裝；簽名和套件名稱衝突                     |
| Windows 11 | 安裝成功；<br/>與舊版的 Snap Hutao 同名共存並造成程式執行錯誤 |

由於上述的問題，您需要先解除安裝舊版 Snap Hutao，然後再安裝 1.9.0 版本安裝套件

> **解除安裝 Snap Hutao 的方法**：在開始功能表找到 Snap Hutao，右鍵點選解除安裝即可；在 Windows 應用程式設定中找到後選擇解除安裝也是快速的方法。

**您的重要資料（包括已登入的米遊社帳號、祈願記錄、成就資料、深境螺旋挑戰記錄、我的角色快取資料、養成計畫）不會遺失，它們仍然儲存於您的本地電腦胡桃數據目錄中。** 但以下資料將會重置：

1. Snap Hutao 執行次數計數
2. 使用者資料夾路徑 **（如果您之前修改了資料目錄，請記住您的資料目錄路徑）**
3. 胡桃帳號登入狀態
4. 已關閉的胡桃公告標記
5. 養成計畫預設等級資訊
6. 主頁儀表闆卡片的狀態
7. 自動連點功能的狀態

### 安裝新版本

![1.8.5版本安裝文件](/images/202312/1-8-5-installer.png)

執行您已經下載好的 1.9.0 版本安裝包，在安裝介面您應該可以看到發布者為 `SignPath Foundation`，點擊安裝您就可以安裝全新版本的 Snap Hutao 了！

**如果您在舊版本修改了資料夾位置，則需要在啟動後重新在設定中選擇資料夾路徑以還原資料。若從未設定過資料夾，您的資料將會直接載入，不需要額外設定。**

## 未來的計劃

>  Microsoft Store 、未來的發布、軟體的安全性...

 Microsoft Store 中上架的應用程式發布者名稱必須為微軟賦予的 GUID，而不能是 `SignPath Foundation` 這樣的「自訂」的名稱。我們預計未來不會在 Microsoft Store 中繼續發布更新的版本，除非我們有更好的方法來處理不同簽名包之間的共存問題。雖然 Snap Hutao 不再經過微軟的認證，但是在 SignPath 的限制下，Snap Hutao 將只能從 GitHub 程式碼庫直接編譯和建置發布包，這意味著使用者的安裝包中的程式碼是100% 源自我們的 GitHub 程式碼庫，任何人都有權限審閱程式碼並參與開發。

自1.9.0版本起的客戶端，我們將內建軟體更新模組以適應新的發布方式，我們會盡可能減少使用者更新時所需要的操作。由於該功能是全新的功能，我們仍在部署過程中，請繼續關注我們的程式內公告和社群以獲取資訊！